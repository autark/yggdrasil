#!/usr/bin/perl

use strict;
use warnings;

BEGIN { our $VERSION = 0.05 }

use FindBin qw($Bin);
use lib qq($Bin/../lib);

use Yggdrasil;

use Yggdrasil::Common::Config;
use Yggdrasil::Common::CommandLine;

use POE::Component::Server::Yggdrasil;

my $cmdline = Yggdrasil::Common::CommandLine->new();

my $label = $cmdline->get('label') || 'default';

my $c = Yggdrasil::Common::Config->new();
my $config = $c->get($label);
die "No such label as $label\n" unless $config;
die "Not a functional server label '$label'" unless $config->get('daemonhost');

# $y->connect( 
# 	    user      => $config->get( 'engineuser' ),
# 	    password  => $config->get( 'enginepassword' ),
# 	    host      => $config->get( 'enginehost' ),
# 	    port      => $config->get( 'engineport' ),
# 	    db        => $config->get( 'enginedb' ),
# 	    engine    => $config->get( 'enginetype' ),
# 	   );

my $self = POE::Component::Server::Yggdrasil->spawn(
	    address => $config->get('daemonhost'),
	    port    => $config->get('daemonport'),
);
print "Foo\n";
POE::Kernel->run();

__DATA__
help here
